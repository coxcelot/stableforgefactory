<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>StableForgeFactory • Base Mainnet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { margin:0; background:#0f1220; color:#e6e8ef; font-family:Inter,system-ui,Arial,sans-serif }
    header{padding:24px;border-bottom:1px solid #22263a}
    header h1{margin:0 0 8px;font-size:22px}
    header p{margin:0;color:#a7adbf;font-size:14px}
    main{max-width:600px;margin:0 auto;padding:24px}
    .card{background:#171a2a;border:1px solid #22263a;border-radius:12px;padding:16px;margin-bottom:16px}
    .btn{background:#2f7df4;color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600}
    .status{font-size:12px;color:#a7adbf;margin-top:8px}
    .mono{font-family:ui-monospace,Menlo,Monaco,Consolas,"Courier New",monospace}
  </style>
</head>
<body>
<header>
  <h1>StableForgeFactory on Base</h1>
  <p>Test frontend with working Connect Wallet button</p>
</header>

<main>
  <section class="card">
    <h2>Network & Wallet</h2>
    <button id="connectBtn" class="btn">Connect Wallet</button>
    <p class="status" id="status">Status: idle</p>
    <div class="mono">Account: <span id="account">—</span></div>
    <div class="mono">Chain: <span id="chain">—</span></div>
  </section>
</main>

<!-- Script at bottom so DOM is ready -->
<script>
let provider, signer, account;
const $ = id => document.getElementById(id);

async function connectWallet() {
  if (!window.ethereum) {
    alert("MetaMask not detected");
    return;
  }
  try {
    // Request accounts
    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
    account = accounts[0];
    provider = new ethers.providers.Web3Provider(window.ethereum);
    signer = provider.getSigner();

    // Update UI
    $('account').textContent = account;
    const net = await provider.getNetwork();
    $('chain').textContent = net.chainId;
    $('status').textContent = "Connected";
    console.log("Connected:", account);
  } catch (err) {
    console.error("Connection failed:", err);
    $('status').textContent = "Connection failed: " + err.message;
  }
}

// Attach listener AFTER DOM is loaded
document.getElementById('connectBtn').addEventListener('click', connectWallet);
</script>
</body>
</html>
